<div class="button-container">
  <button mat-raised-button color="primary" (click)="uploadPayments()">
    {{!uploadComplete?'Upload all':'Retry'}}
  </button>

  <div
    *ngIf="!loading && uploadComplete"
    fxLayout="row wrap"
    fxLayoutAlign="space-around center"
  >
    <h3>Total: {{ payments.length }}</h3>
    <h3 class="successful">Successful: {{ successfullyPaidFundraisers.length }}</h3>
    <h3 class="already-paid">Already paid: {{ alreadyPaidFundraisers.length }}</h3>
    <h3 class="failed">Failed: {{ paymentFailedFundraisers.length }}</h3>
  </div>
</div>

<div *ngIf="loading">
  <mat-progress-bar mode="indeterminate"></mat-progress-bar>>
</div>

<p
  *ngIf="!loading && errorMessage"
  class="text-error"
  style="text-align: center"
>
  {{ errorMessage }}
</p>
<mat-table
  matSort
  [dataSource]="dataSource"
  matTableExporter
  #exporter="matTableExporter"
  matSort
>
  <ng-container matColumnDef="firstName">
    <mat-header-cell *matHeaderCellDef> First name </mat-header-cell>
    <mat-cell *matCellDef="let element">
      {{ element.firstName | titlecase }}
    </mat-cell>
  </ng-container>

  <ng-container matColumnDef="lastName">
    <mat-header-cell *matHeaderCellDef> Last name </mat-header-cell>
    <mat-cell *matCellDef="let element">
      {{ element.lastName | titlecase }}
    </mat-cell>
  </ng-container>

  <ng-container matColumnDef="bankName">
    <mat-header-cell *matHeaderCellDef mat-sort-header>
      Bank name
    </mat-header-cell>
    <mat-cell *matCellDef="let element">
      {{ element.bankName | titlecase }}
    </mat-cell>
  </ng-container>

  <ng-container matColumnDef="bankAccountNo">
    <mat-header-cell *matHeaderCellDef mat-sort-header>
      Bank account no.</mat-header-cell
    >
    <mat-cell *matCellDef="let element">
      {{ element.bankAccountNo }}
    </mat-cell>
  </ng-container>
  <ng-container matColumnDef="amount">
    <mat-header-cell *matHeaderCellDef mat-sort-header> Amount</mat-header-cell>
    <mat-cell *matCellDef="let element">
      {{ element.amount | number: ".2" }}
    </mat-cell>
  </ng-container>
  <ng-container matColumnDef="fundraiserId">
    <mat-header-cell *matHeaderCellDef mat-sort-header
      >Fundraiser ID</mat-header-cell
    >
    <mat-cell *matCellDef="let element">
      {{ element.fundraiserId }}
    </mat-cell>
  </ng-container>

  <ng-container matColumnDef="status">
    <mat-header-cell *matHeaderCellDef mat-sort-header>Status</mat-header-cell>
    <mat-cell *matCellDef="let element">
      {{ element.status }}
    </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
  <mat-row [class]="
  alreadyPaidFundraisers.includes(row.fundraiserId)?'already-paid'
  : successfullyPaidFundraisers.includes(row.fundraiserId)?'successful'
  : paymentFailedFundraisers.includes(row.fundraiserId)?'failed'
  :''" *matRowDef="let row; columns: displayedColumns"></mat-row>
  <mat-row *matNoDataRow>No approved withdrawal requests yet.</mat-row>
</mat-table>
<mat-paginator
  [pageSizeOptions]="[5, 10, 20]"
  showFirstLastButtons
  aria-label="Select page"
>
</mat-paginator>
